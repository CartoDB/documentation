## h3

[H3](https://eng.uber.com/h3/) is Uberâ€™s Hexagonal Hierarchical Spatial Index. Full documentation of the project can be found at [h3geo](https://h3geo.org/docs).

### ST_ASH3

{{% bannerNote type="code" %}}
bqcarto.h3.ST_ASH3(geog, resolution)
{{%/ bannerNote %}}

* `geog`: POINT `GEOGRAPHY`.
* `resolution`: `INT64` number between 0 and 15 with the [H3 resolution](https://h3geo.org/docs/core-library/restable).

Returns an H3 cell index where the point is placed in the required `resolution` as an `INT64` number. It will return `NULL` on error (invalid geography type or resolution out of bounds).

{{% bannerNote type="note" title="tip"%}}
If you want the HEX representation of the cell, you can call [H3_ASHEX](#h3h3_ashex) with the output integer.
{{%/ bannerNote %}}

{{% bannerNote type="note" title="tip"%}}
If you want the cells covered by a POLYGON see [ST_ASH3_POLYFILL](#h3st_ash3_polyfill).
{{%/ bannerNote %}}

### LONGLAT_ASH3

{{% bannerNote type="code" %}}
bqcarto.h3.LONGLAT_ASH3(longitude, latitude, resolution)
{{%/ bannerNote %}}

* `latitude`: `FLOAT64` point latitude in degrees.
* `longitude`: `FLOAT64` point latitude in degrees.
* `resolution`: `INT64` number between 0 and 15 with the [H3 resolution](https://h3geo.org/docs/core-library/restable).

Returns an `INT64` H3 cell index where the point is placed in the required `resolution` as an `INT64` number. It will return `NULL` on error (resolution out of bounds).

### H3_ASHEX

{{% bannerNote type="code" %}}
bqcarto.h3.H3_ASHEX(index)
{{%/ bannerNote %}}

* `index`: `INT64` H3 cell index.

Returns a `STRING` representing the H3 index as a hexadecimal number. It doesn't do any extra validation checks.

### H3_FROMHEX

{{% bannerNote type="code" %}}
bqcarto.h3.H3_FROMHEX(index)
{{%/ bannerNote %}}

* `index`: `STRING` H3 cell index as hexadecimal. 

Returns the `INT64` representation of a H3 index from the `STRING` (generated by [H3_ASHEX](#h3h3_ashex)). It doesn't do any extra validation checks.


### ST_ASH3_POLYFILL

{{% bannerNote type="code" %}}
bqcarto.h3.ST_ASH3_POLYFILL(geography, resolution)
{{%/ bannerNote %}}

* `geography`: `GEOGRAPHY` **POLYGON** or **MULTIPOLYGON** representing the area to cover.
* `resolution`: `INT64` number between 0 and 15 with the [H3 resolution](https://h3geo.org/docs/core-library/restable).

Returns an `ARRAY` with all the `INT64` H3 cell indexes **with centers** contained in a given polygon. It will return `NULL` on error (invalid geography type or resolution out of bounds).

### ST_BOUNDARY

{{% bannerNote type="code" %}}
bqcarto.h3.ST_BOUNDARY(index)
{{%/ bannerNote %}}

* `index`: `INT64` The H3 cell index.

Returns a `GEOGRAPHY` representing the H3 cell. It will return `NULL` on error (invalid input).

### ISVALID

{{% bannerNote type="code" %}}
bqcarto.h3.ISVALID(index)
{{%/ bannerNote %}}

* `index`: `INT64` The H3 cell index.

Returns a `BOOLEAN` of value `true` when the given index is valid, `false` otherwise.

### COMPACT

{{% bannerNote type="code" %}}
bqcarto.h3.COMPACT(indexArray)
{{%/ bannerNote %}}

* `indexArray`: `ARRAY<INT64>` of H3 cell indices of the same resolution.

Returns an `ARRAY` with the `INT64` indexes of a set of hexagons across multiple resolutions that represent the same area as the input set of hexagons.


### UNCOMPACT

{{% bannerNote type="code" %}}
bqcarto.h3.UNCOMPACT(indexArray, resolution)
{{%/ bannerNote %}}

* `indexArray`: `ARRAY<INT64>` of H3 cell indices.
* `resolution`: `INT64` number between 0 and 15 with the [H3 resolution](https://h3geo.org/docs/core-library/restable).

Returns an `ARRAY` with the `INT64` indexes of a set of hexagons of the same `resolution` that represent the same area as the [compacted](#h3compact) input hexagons.

### TOPARENT

{{% bannerNote type="code" %}}
bqcarto.h3.TOPARENT(index, resolution)
{{%/ bannerNote %}}

* `index`: `INT64` H3 cell index.
* `resolution`: `INT64` number between 0 and 15 with the [H3 resolution](https://h3geo.org/docs/core-library/restable).

Returns the `INT64` H3 cell index of the parent of the given hexagon at the given resolution.

### TOCHILDREN

{{% bannerNote type="code" %}}
bqcarto.h3.TOCHILDREN(index, resolution)
{{%/ bannerNote %}}

* `index`: `INT64` H3 cell index.
* `resolution`: `INT64` number between 0 and 15 with the [H3 resolution](https://h3geo.org/docs/core-library/restable).

Returns an `ARRAY` with the `INT64` indexes of the children/descendents of the given hexagon at the given resolution.

### ISPENTAGON

{{% bannerNote type="code" %}}
bqcarto.h3.ISPENTAGON(index)
{{%/ bannerNote %}}

* `index`: `INT64` The H3 cell index.

Returns a `BOOLEAN` determining whether the given H3 index is a pentagon. Returns `false` on invalid input.

### DISTANCE

{{% bannerNote type="code" %}}
bqcarto.h3.DISTANCE(origin, destination)
{{%/ bannerNote %}}

* `origin`: `INT64` origin H3 cell index.
* `destination`: `INT64` destination H3 cell index.

Returns the `INT64` **grid distance** between two hexagon indexes. This function may fail to find the distance between two indexes if they are very far apart or on opposite sides of a pentagon.
Returns null on failure or invalid input.

{{% bannerNote type="note" title="tip"%}}
If you want the distance in meters use [ST_DISTANCE](https://cloud.google.com/bigquery/docs/reference/standard-sql/geography_functions#st_distance) between the cells ([ST_BOUNDARY](#h3st_boundary)) or their centroid.
{{%/ bannerNote %}}

### KRING

{{% bannerNote type="code" %}}
bqcarto.h3.KRING(index, distance)
{{%/ bannerNote %}}

* `index`: `INT64` H3 cell index.
* `distance`: `INT64` distance (in number of cells) to the source.

Returns an `ARRAY` with the `INT64` indexes of all hexagons within `distance` of the given input hexagon. The order of the hexagons is undefined. Returns NULL on invalid input.

### HEXRING

{{% bannerNote type="code" %}}
bqcarto.h3.HEXRING(index, distance) -> ARRAY<INT64>
{{%/ bannerNote %}}

* `index`: `INT64` H3 cell index.
* `distance`: `INT64` distance (in cells) to the source.

Get all hexagons in a **hollow hexagonal ring** centered at origin with sides of a given length. Unlike kRing, this function will return NULL if there is a pentagon anywhere in the ring.

### VERSION

{{% bannerNote type="code" %}}
bqcarto.h3.VERSION()
{{%/ bannerNote %}}

Returns a `STRING` with the current version of the H3 library.