{{ define "main" }}
  <header class="is-bgBaseGrey is-txtWhite">
    <div class="container grid u-justify-center">
      <div class="navbar grid-cell--col12">
        {{ partial "navbar.html" (dict "CTX" .) }}
      </div>
      <div class="grid-cell grid-cell--col10 u-mt64 u-mb64 u-pr">
        <div class="u-flex u-align-center">
          <img class="header__icon u-mr24" src="{{.Params.icon}}" alt="{{.Params.title}}">
          <h1 class="title f48 f36--mobile is-txtWhite">{{.Params.title}}</h1>
        </div>
        <div class="u-flex u-align-center u-mt16">
          <p class="text f20 is-txtWhite u-mr16">{{.Params.description}}</p>
          <div class="u-flex">
            {{if .Params.repoUrl}}
              <a href="{{.Params.repoUrl}}" class="button button--small is-outline is-white u-flex u-mr8" target="_blank">
                <img class="u-mr8" src="/img/documentation/github.svg" alt="Github">
                <span>Code</span>
              </a>
            {{end}}
            {{if .Params.changelog}}
              <a href="{{.Params.changelog}}" class="button button--small is-outline is-white" target="_blank">
                <span>Changelog</span>
              </a>
            {{end}}
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="is-bgWhite is-txtBaseGrey">
    <div class="container grid u-justify-center u-mt64 u-mb96 u-mt48--tablet u-mb48--tablet">
      <aside class="grid-cell grid-cell--col3 title f12 desktop-s toc--sidebar js-toc-sidebar">
        <div class="toc--container js-toc-sidebar-container">
          <h3 class="title f16 is-txtNavyBlue toc--title">{{.Params.title}}</h3>
          {{$context := .}}
          {{$folderOneName := printf "%s%s" (urlize .Params.name) "/"}}
          {{$overview := printf "%s%s" $folderOneName "overview.md"}}
          {{$reference := printf "%s%s" $folderOneName "reference.md"}}

          <div class="toc--links">
            {{if fileExists $overview}}
              {{$isActive := eq $overview .File.Path}}
              {{if $isActive}}
                <div class="toc-hugo__folder-one">
                  {{.TableOfContents}}
                </div>
              {{else}}
                <a href="{{(.GetPage $overview).Permalink}}" class="toc--link level-one">Overview</a>
              {{end}}
            {{end}}

            {{if .Params.extra_sections}}
              {{range $elem := .Params.extra_sections}}
                {{$file := printf "%s%s%s" $folderOneName (urlize $elem) ".md"}}
                {{$isActive := eq $file $context.File.Path}}
                {{if $isActive}}
                  <div class="toc-hugo__folder-one">
                    {{.TableOfContents}}
                  </div>
                {{else}}
                  <a href="{{($context.GetPage (printf " %s%s" "/" $file)).Permalink}}" class="toc--link level-one">{{$elem}}</a>
                {{end}}
              {{end}}
            {{end}}

            {{if .Params.folders}}
              {{range $folderTwo := .Params.folders}}
                {{$folderTwoName := printf "%s%s" (urlize $folderTwo.name) "/"}}
                <ul>
                  <li>
                    <button class="toc--link level-one dropdown-button" data-toggle="dropdown" {{ if in $context.File.Dir $folderTwoName }} data-start-open="true" {{ end }}>
                      <div>
                        <!-- Safari doesn't allow flex directly in button-->
                        <span>{{$folderTwo.name}}</span>
                        <svg class="caret" stroke="currentColor" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
                          <path fill="#162945" fill-rule="evenodd" d="M11.569 5.431L8.04 8.96 4.511 5.431l-.942.943 4.471 4.471 4.471-4.471z"/>
                        </svg>
                      </div>
                    </button>
                    <div class="dropdown-menu">
                      {{range $elemFolderTwo := $folderTwo.elements}}
                        {{$fileFolderTwo := printf "%s%s%s%s" $folderOneName $folderTwoName (urlize $elemFolderTwo) ".md"}}
                        {{$isActive := eq $fileFolderTwo $context.File.Path}}

                        {{if $isActive}}
                          <div class="toc-hugo__folder-two">
                            {{$context.TableOfContents}}
                          </div>
                        {{else}}
                          <ul>
                            <li>
                              <a href="{{($context.GetPage (urlize $fileFolderTwo)).Permalink}}" class="toc--link level-two">{{$elemFolderTwo}}</a>
                            </li>
                          </ul>
                        {{end}}
                      {{end}}

                      <!-- Start SubFolder -->
                      {{if $folderTwo.folders }}
                        {{range $folderThree := $folderTwo.folders}}
                          {{$folderThreeName := printf "%s%s" (urlize $folderThree.name) "/"}}
                          <ul>
                            <li>
                              <button class="toc--link level-two dropdown-button" data-toggle="dropdown" {{ if in $context.File.Dir $folderThreeName }} data-start-open="true" {{ end }}>
                                <div>
                                  <!-- Safari doesn't allow flex directly in button-->
                                  <span>{{$folderThree.name}}</span>
                                  <svg class="caret" stroke="currentColor" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
                                    <path fill="#162945" fill-rule="evenodd" d="M11.569 5.431L8.04 8.96 4.511 5.431l-.942.943 4.471 4.471 4.471-4.471z"/>
                                  </svg>
                                </div>
                              </button>
                              <div class="dropdown-menu">
                                {{range $elemFolderThree := $folderThree.elements}}
                                  {{$fileFolderThree := printf "%s%s%s%s%s" $folderOneName $folderTwoName $folderThreeName (urlize $elemFolderThree) ".md"}}
                                  {{$isActiveChild := eq $fileFolderThree $context.File.Path}}

                                  {{if $isActiveChild}}
                                    <div class="toc-hugo__folder-three">
                                      {{$context.TableOfContents}}
                                    </div>
                                  {{else}}
                                    <ul>
                                      <li>
                                        <a href="{{($context.GetPage (urlize $fileFolderThree)).Permalink}}" class="toc--link level-three">{{$elemFolderThree}}</a>
                                      </li>
                                    </ul>
                                  {{end}}
                                {{end}}
                              </div>
                            </li>
                          </ul>
                        {{end}}
                      {{end}}
                      <!-- End SubFolder -->
                    </div>
                  </li>
                </ul>
              {{end}}
            {{end}}
            {{if fileExists $reference}}
              {{$isActive := eq (printf "%s%s" $folderOneName "reference.md") .File.Path}}
              {{if $isActive}}
                <div class="toc-hugo__folder-one">
                  {{.TableOfContents}}
                </div>
              {{else}}
                <a href="{{(.GetPage $reference).Permalink}}" class="toc--link level-one">Reference</a>
              {{end}}
            {{end}}
          </div>
        </div>
      </aside>
      <div class="grid-cell grid-cell--col7 grid-cell--col10--tablet content__default u-mb96 js-content">
        {{.Content}}
      </div>
    </div>
  </div>
{{end}}
